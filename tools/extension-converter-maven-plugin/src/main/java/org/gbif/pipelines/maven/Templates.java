package org.gbif.pipelines.maven;

/**
 * Simplification for template loading from resources, there is a copy of this template in the
 * resources directory, so you can change it and copy-past as a new template
 */
public class Templates {

  public static final String TABLE_CONVERTER =
      "package ${packagePath};\n"
          + "\n"
          + "import java.util.Optional;\n"
          + "import java.util.function.Function;\n"
          + "\n"
          + "import org.gbif.api.vocabulary.Extension;\n"
          + "import org.gbif.dwc.terms.DwcTerm;\n"
          + "import org.gbif.pipelines.core.interpreters.ExtensionInterpretation;\n"
          + "import org.gbif.pipelines.core.interpreters.ExtensionInterpretation.TargetHandler;\n"
          + "import ${namespace}.BasicRecord;\n"
          + "import ${namespace}.ExtendedRecord;\n"
          + "import ${namespace}.${extensionPackage}.${tableName};\n"
          + "\n"
          + "import lombok.AccessLevel;\n"
          + "import lombok.NoArgsConstructor;\n"
          + "\n"
          + "/**\n"
          + " * Autogenerated by extension-converter-maven-plugin. DO NOT EDIT DIRECTLY\n"
          + " *\n"
          + " * Converts/maps form {@link ExtendedRecord} to {@link ${tableName}}.\n"
          + " */\n"
          + "@NoArgsConstructor(access = AccessLevel.PRIVATE)\n"
          + "public class ${tableName}Converter {\n"
          + "\n"
          + "  private static final Function<${tableName}, TargetHandler<${tableName}>>\n"
          + "      VERBATIM_HANDLER =\n"
          + "          mft ->\n"
          + "              ExtensionInterpretation.extension(\"${rowType}\")\n"
          + "                  .to(() -> mft)\n"
          + "                  // Verbatim\n"
          + "              <#list setters as setter>\n"
          + "                  .map(\"${setter.qualifier}\", ${tableName}::set${setter.vName})\n"
          + "              </#list>;\n"
          + "\n"
          + "  private static final Function<${tableName}, TargetHandler<${tableName}>>\n"
          + "      INTERPRETED_HANDLER =\n"
          + "          mft ->\n"
          + "              ExtensionInterpretation.extension(\"${rowType}\")\n"
          + "                  .to(() -> mft)\n"
          + "                  // Interpreted\n"
          + "              <#list setters as setter>\n"
          + "                  .map(\"${setter.qualifier}\", ${tableName}::set${setter.name})\n"
          + "              </#list>;\n"
          + "\n"
          + "  /**\n"
          + "   * Converts an extension of a {@link ExtendedRecord} and populates a {@link\n"
          + "   * ${tableName}} with verbatim and interpreted values.\n"
          + "   */\n"
          + "  public static Optional<${tableName}> convert(BasicRecord br, ExtendedRecord er) {\n"
          + "    if (er == null || br == null) {\n"
          + "      return Optional.empty();\n"
          + "    }\n"
          + "    ${tableName} table =\n"
          + "        ${tableName}.newBuilder().setGbifid(br.getGbifId()).build();\n"
          + "\n"
          + "    return VERBATIM_HANDLER\n"
          + "        .apply(table)\n"
          + "        .convert(er)\n"
          + "        .get()\n"
          + "        .flatMap(x -> INTERPRETED_HANDLER.apply(x).convert(er).get());\n"
          + "  }\n"
          + "}\n";

  private Templates() {}
}
